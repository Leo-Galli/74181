name: 74181 Workbench

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: write

jobs:
  build-and-profile:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y build-essential linux-tools-common linux-tools-generic curl

    - name: Compile 74181.c
      run: gcc -Wall -Wextra -O2 -std=c99 74181.c -o 74181

    - name: Prepare directories
      run: mkdir -p runs logs badges

    - name: Generate comprehensive test cases (including errors)
      run: |
        cat > test_cases.txt <<'EOF'
# === ALU 74181 (Opzione 1) ===
1,S,0,0,0,0,0,0,0,0,0,0,0,0,0
1,S,1,0,1,1,0,1,0,1,1,0,1,0,1
1,N,1,1,1,1,1,1,1,1,1,1,1,1,1
# === Calcolatrice (Opzione 3) ===
3,1,10,20,30,x
3,2,100,10,x
3,3,7,8,x
3,4,1000,4,x
3,5,(10+2)*3-6
3,5,2*(3+4)
3,5,(10+2*3
3,5,abc+def
3,5,10/0
# === Bin → Dec (Opzione 4) ===
4,S,101010
4,S,11111111
4,S,0
4,S,102010
4,S,abc101
# === Dec → Bin (Opzione 5) ===
5,S,42
5,S,255
5,S,0
5,S,-5
5,S,abc
# === ALU32 (Opzione 6) ===
6,S,100,200
6,S,4294967295,1
6,S,0,0
6,S,abc,def
6,S,-1,10
# === ALU32 con clock (Opzione 7) ===
7,S,12345,67890
7,S,1,1
7,S,0,0
7,S,abc,123
# === Opzioni passive ===
8
9
EOF
